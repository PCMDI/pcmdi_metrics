

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Using the Package &mdash; PCMDI Metrics 1.2.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> PCMDI Metrics
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Technical-overview.html">Technical Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="install-using-anaconda.html">Install using Anaconda</a></li>
<li class="toctree-l1"><a class="reference internal" href="Supporting-data.html">Retrieving data for demos and use of the PMP</a></li>
<li class="toctree-l1"><a class="reference internal" href="metrics-overview.html">Documentation and Demos</a></li>
<li class="toctree-l1"><a class="reference internal" href="pmpparser.html">PMPParser</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PCMDI Metrics</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Using the Package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/using-the-package.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="using-the-package">
<span id="id1"></span><h1>Using the Package<a class="headerlink" href="#using-the-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="getting-started">
<h2>GETTING STARTED<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<p>Installation requirements and instructions are available at: <a class="reference external" href="https://github.com/PCMDI/pcmdi_metrics/wiki/Install">https://github.com/PCMDI/pcmdi_metrics/wiki/Install</a></p>
<p>Some installation support for modeling groups participating in CMIP is available via <a class="reference external" href="mailto:pcmdi-metrics&#37;&#52;&#48;llnl&#46;gov">pcmdi-metrics<span>&#64;</span>llnl<span>&#46;</span>gov</a></p>
<p>To verify the PMP environment is successfully set up, try the following at the unix command prompt ($):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ which python
</pre></div>
</div>
<p>This should point you to something like: {HOMEDIRECTORY}/anaconda2/bin/python, where the {HOMEDIRECTORY} is where you installed the PMP using the anaconda instructions.  If instead you are pointed to /usr/bin/python, this is the default python installed on your computer and it means the PMP is not yet recognized in your current window.  If that is the case, make sure anaconda is in your ${PATH} and if necessary revisit the instructions for installing the PMP with Anaconda.</p>
<p>Next try:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ which pcmdi_metrics_driver.py
</pre></div>
</div>
<p>If this file is found, there is a good chance you have your PMP environment set up properly, so you can proceed to working with some of the demos below.</p>
</div>
<div class="section" id="user-guide-pmp-v1-1">
<h2>USER GUIDE PMP v1.1<a class="headerlink" href="#user-guide-pmp-v1-1" title="Permalink to this headline">¶</a></h2>
<p>(in progress, last updated May 31, 2016)</p>
<div class="section" id="overview">
<h3>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h3>
<p>The PMP uses the Python programming language and the Ultrascale Visualization Climate Data Analysis Tools (UV-CDAT), a powerful software tool kit that provides cutting-edge climate diagnostic and visualization capabilities. It can be set up for users unfamiliar with Python and UV-CDAT to test their own models with some help from the PMP developers (<a class="reference external" href="mailto:pcmdi-metrics&#37;&#52;&#48;llnl&#46;gov">pcmdi-metrics<span>&#64;</span>llnl<span>&#46;</span>gov</a>). However, users with a little Python experience will have access to a wide range of analysis capabilities and more readily be able to adapt the PMP functions for their own purposes. <strong>Users of the current release (v1.1) will need to contact the PMP developers (pcmdi-metrics&#64;llnl.gov) to get started, obtain access to the PMP observational database, and set up the package for their application.</strong>
The primary functionality of the PMP v1.1 is to compute a wide range of climatological statistics and relate them to the CMIP multi-model ensemble. Well-established ENSO and monsoon statistics are in a development repository that will soon be merged with the master repository. A critical design constraint of the PMP is that it is closely aligned with the data standards and conventions of CMIP. Coupled with the capabilities of UV-CDAT, this offers a powerful and extensible analysis framework that can be readily extendable and will serve as a basis for systematic characterization of all CMIP DECK and historical simulations.</p>
</div>
<div class="section" id="usage">
<h3>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h3>
<p>Steps to start using the v.1.1 package include:</p>
<ol class="arabic simple">
<li><p>Install the PMP</p></li>
<li><p>Ensure your simulation output is structured similar to CMIP and obtain the PMP observational database from the PMP developers.</p></li>
<li><p>Prepare a test “input parameter file” to read input model data and observations, select which variables to test, and where to output the results (see demo examples below)</p></li>
<li><p>Once a parameter file is successfully set up the PMP can be executed, providing summary statistics output as JSON files (<a class="reference external" href="http://www.json.org/">http://www.json.org/</a>)</p></li>
<li><p>The output (JSON files) can be used to produce plots that compare models with observations and other CMIP simulations, either with the user’s preferred plotting tools or those provided with the PMP.</p></li>
</ol>
</div>
<div class="section" id="preparing-model-data-for-use-with-the-pmp">
<h3>Preparing model data for use with the PMP<a class="headerlink" href="#preparing-model-data-for-use-with-the-pmp" title="Permalink to this headline">¶</a></h3>
<p>The key to being able to operate the PMP is that all climate model output must closely match the data conventions of CMIP. If a model’s output was processed with CMOR, it will almost certainly be readably by the PMP. Without this, there are a number of technical details a user will have to be cognizant of to ensure their data can be read by the PMP. There is some flexibility - it is possible for a user to keep their own variable names and units. The primary analysis in the PMP v1.1 is on the climatological annual cycle, and it is currently assumed a user already routinely computes these (code for this will be provided in v1.2). It is expected that the 12-month climatological time series is in a single netCDF file with variable dimensions (12, latitude, longitude) starting in January and ending in December. In v1.1 the PMP relies on the time index (0-11 in Python) in the climatologies so the datum and units of the time axis are not important.</p>
<p>If the 12 month annual cycle climatology is not in a single file, there is a powerful UV-CDAT utility (cdscan) included in the PMP that can be used to “span in time” across multiple files. cdscan is a command line operation that can be used to create an xml that can be read by the PMP (via CDMS).   See <a class="reference external" href="http://uvcdat.llnl.gov/documentation/cdms/cdms_7.html">http://uvcdat.llnl.gov/documentation/cdms/cdms_7.html</a></p>
<p>The PMP observational database is organized very similar to how CMIP model output is organized on the ESGF.  Users should contact the PMP developers (<a class="reference external" href="mailto:pcmdi-metrics&#37;&#52;&#48;llnl&#46;gov">pcmdi-metrics<span>&#64;</span>llnl<span>&#46;</span>gov</a>) to obtain a copy.  Additional datasets can be added to the database provided they are done so in a way that adheres to the directory structure of the database.  Once they are added, for local execution of the PMP a simple script (<a class="reference external" href="https://github.com/PCMDI/pcmdi_metrics/blob/master/src/python/pcmdi/scripts/build_obs_meta_dictionary.py">https://github.com/PCMDI/pcmdi_metrics/blob/master/src/python/pcmdi/scripts/build_obs_meta_dictionary.py</a>) needs to be updated and executed.  For collaborators wishing to contribute new observations into the master PMP, a GIT branch should be created with a pull request.</p>
<p>With the model and observational data are properly structured and organized, the next step is to set up a parameter file. This parameter file is a python “.py” file where the user specifies the file/directory structure of both the model and observational data as well as the variables for which the user wants to compute summary statistics. There are other options set in this file such as the target grid resolution, whether or not the user wants to save the interpolated climatologies, compute statistics over ocean only, etc.   Output is saved as a “json” file, an internationally recognized lightweight data-interchange format that is easy to read and write (json.org).  For our purposes, it is especially powerful as a simple database for organizing the summary statistics computed by the PMP and enabling them to be easily read in python.
As example script is provided described in the demo package described below.</p>
</div>
</div>
<div class="section" id="demos">
<h2>Demos<a class="headerlink" href="#demos" title="Permalink to this headline">¶</a></h2>
<div class="section" id="running-the-pmp-climate-statistics">
<h3>Running the PMP climate statistics<a class="headerlink" href="#running-the-pmp-climate-statistics" title="Permalink to this headline">¶</a></h3>
<p>The PMP v1.1 summary statistics are executed with a parameter file as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$  pcmdi_metrics_driver.py -p /MY_PATH/my_parameter_file.py
</pre></div>
</div>
<p>Where “my_parameter_file.py” is your customized input parameter file and “MY_PATH” is the location of the parameter file.</p>
<p>Before setting up your own input parameter file, we suggest you run our first demo which highlights the function of parameter file with a simple test case, and then uses this to execute the PMP.  With the PMP properly installed, you should be able to execute the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pmp_demo_1.py
</pre></div>
</div>
<p>As part of running this demo a tar file with model and observational data for the demo will be downloaded from <a class="reference external" href="http://oceanonly.llnl.gov/gleckler1/pmp-demo-data/pmpv1.1_demodata.tar">http://oceanonly.llnl.gov/gleckler1/pmp-demo-data/pmpv1.1_demodata.tar</a></p>
</div>
<div class="section" id="reading-the-summary-statistics-produced-by-the-pmp">
<h3>Reading the summary statistics produced by the PMP<a class="headerlink" href="#reading-the-summary-statistics-produced-by-the-pmp" title="Permalink to this headline">¶</a></h3>
<p>A sample script for reading in PMP results is available on the PMP github repository:
<a class="reference external" href="https://github.com/PCMDI/pcmdi_metrics/blob/master/doc/simple_json_test.py">https://github.com/PCMDI/pcmdi_metrics/blob/master/doc/simple_json_test.py</a></p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020 PCMDI

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>