

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Mean Climate &mdash; PCMDI Metrics 1.2.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Sub-daily precipitation" href="subdaily-precipitation.html" />
    <link rel="prev" title="Documentation and Demos" href="metrics-overview.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> PCMDI Metrics
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Technical-overview.html">Usage Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Install using Anaconda</a></li>
<li class="toctree-l1"><a class="reference internal" href="Supporting-data.html">Retrieving data for demos and use of the PMP</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="metrics-overview.html">Documentation and Demos</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="metrics-overview.html#overview">Overview</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Mean Climate</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="subdaily-precipitation.html">Sub-daily precipitation</a></li>
<li class="toctree-l3"><a class="reference internal" href="extrop-mov.html">Extra-tropical modes of variability</a></li>
<li class="toctree-l3"><a class="reference internal" href="clivar-enso-metrics.html">CLIVAR 2020 ENSO Metrics</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pmpparser.html">Miscellaneous</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PCMDI Metrics</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="metrics-overview.html">Documentation and Demos</a> &raquo;</li>
        
      <li>Mean Climate</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/mean-climate.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="mean-climate">
<span id="using-the-package"></span><h1>Mean Climate<a class="headerlink" href="#mean-climate" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>The mean climate summary statistics are the most routine analysis available from the PMP.  Because they are quasi-operationally applied to large numbers of simulations and under different conditions, the current mode of opertation is fairly general.  Before it can be applied some prepration is needed including:</p>
<ul class="simple">
<li><p>Setting-up observational climatologies</p></li>
<li><p>Construction of model climatologies</p></li>
<li><p>Construction of an input parameter file to run the desired operations</p></li>
</ul>
<p>Each of these steps are included in the <a class="reference external" href="https://github.com/PCMDI/pcmdi_metrics/blob/master/doc/jupyter/Demo/Demo_1_mean_climate.ipynb">mean climate notebook</a> along with a series of examples that demonstrate the options. These steps are also summarized below.</p>
<div class="section" id="observational-climatologies">
<h3>Observational climatologies<a class="headerlink" href="#observational-climatologies" title="Permalink to this headline">¶</a></h3>
<p>A subset of the observational climatologies used for the PMP’s mean climate metrics is available via a <a class="reference external" href="https://github.com/PCMDI/pcmdi_metrics/blob/master/doc/jupyter/Demo/Demo_0_download_data.ipynb">jupyter notebook demo</a>.  Once you have run this demo or downloaded this demo data you can interactively run the mean climate and other demos.  The complete database of <a href="#id1"><span class="problematic" id="id2">`</span></a>observational climatologies is available to users of the PMP. To obtain this, please contact the PMP user group (<a class="reference external" href="mailto:pcmdi-metrics&#37;&#52;&#48;llnl&#46;gov">pcmdi-metrics<span>&#64;</span>llnl<span>&#46;</span>gov</a>) and you will be promptly provided with the database.</p>
<p>The PMP’s mean climate summary statistics can be applied to many fields and in most cases there is more than one reference data set available.  To accomodate this, the observational climatologies used by the PMP are managed via <a class="reference external" href="https://github.com/PCMDI/pcmdi_metrics/blob/master/doc/pcmdiobs2_clims_byVar_catalogue_v20201210.json">a simple catalogue in the form of a JSON file</a>.  For many of the variables there are ‘default’ and ‘alternate1’ datasets and for some there is also an ‘alternate2’.  To simplify the use of the different options in the mean climate, the mean_climate_driver.py (see below) expects to be pointed to observational catalogue.  Currently, if a user wants to add additional observational data this can be done by including it in the JSON cataloge. However, this most be done carefully to ensure the file retains JSON compliant structure.</p>
<p>A recent observational climatology catalogue is included as part of the PMP as a default, so it does not need to be explicitly idenified when using the mean_climate_driver.py (unless the catalogue has been modified to include new observations). However, as described below, the user must provide the base path to the observational database. As indicated in the catalogue, the actual database does incorporate futher directory structure and defined filenames which should not be modified.  If changes are made to the catalogue, this can be done with input parameter settings (below) using the “custom_observations” option.</p>
</div>
<div class="section" id="preparation-of-model-climatologies">
<h3>Preparation of model climatologies<a class="headerlink" href="#preparation-of-model-climatologies" title="Permalink to this headline">¶</a></h3>
<p>Sample model climatologies are available as part of the PMP demo database noted above and are used for the mean climate notebook. However, if a user wants to create and use their own model climatologies with the PMP a simple example is provide in a stand alone <a class="reference external" href="https://github.com/PCMDI/pcmdi_metrics/blob/master/doc/jupyter/Demo/Demo_1a_compute_climatologies.ipynb">climatology notebook</a>, via the <a class="reference external" href="https://github.com/PCMDI/pcmdi_metrics/blob/master/doc/jupyter/Demo/Demo_1_mean_climate.ipynb">mean climate metrics notebook</a>, or the <a class="reference external" href="https://github.com/PCMDI/pcmdi_metrics/tree/master/sample_setups/pcmdi_parameter_files/mean_climate/make_clims">PMP github repository</a>.</p>
</div>
<div class="section" id="construction-of-an-input-paramater-file">
<h3>Construction of an input paramater file<a class="headerlink" href="#construction-of-an-input-paramater-file" title="Permalink to this headline">¶</a></h3>
<p>The PMP mean climate metrics can be controlled via an input parameter file, the command line, or both.  With the command line only it is executed via:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mean_climate_driver</span><span class="o">.</span><span class="n">py</span>  <span class="o">-</span><span class="n">p</span> <span class="n">basic_param</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>or as a combination of an input parameter file and the command line, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mean_climate_driver</span><span class="o">.</span><span class="n">py</span>  <span class="o">-</span><span class="n">p</span> <span class="n">basic_param</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="nb">vars</span> <span class="n">rlut</span> <span class="n">pr</span>
</pre></div>
</div>
<p>where the list of variables (vars) to run the analysis on includes ‘rlut’ (outgoing TOA longwave radiation) and ‘pr’ (precipitation).  The following parameters are <strong>required to be set by the user</strong> either in a parameter file or on the command line:</p>
<ul class="simple">
<li><p><strong>vars</strong>: a python list of variables to apply the summary statistics, e.g., [‘pr’, ‘rlut’, ‘tas’]</p></li>
<li><p><strong>test_data_set</strong>: a python list of runs or models, e.g., [‘ACCESS-1-0’, ‘CESM1’]</p></li>
<li><p><strong>filename_template</strong>: template that is applicable for the runs in test_data_set, e.g., “CMIP5.historical.%(model_version).r1i1p1.mon.%(variable).198101-200512.AC.v20190225.nc” where “model_version” and “variable” will be analyzed for each of the entries in test_data_set and vars.</p></li>
<li><p><strong>test_data_path</strong>: the path/template where the test_data resides, e.g.:</p></li>
<li><p><strong>reference_data_set</strong>: a python list that specifies ‘default’, ‘alternate1’, ‘alternate2’ or ‘all’, e.g., [‘default’]</p></li>
<li><p><strong>reference_data_path</strong>: the root path to the observational climatology database, e.g., ‘~/demo_data/PCMDIobs2_clims/’</p></li>
<li><p><strong>target_grid</strong>: ‘2.5x2.5’ or an actual cdms2 grid object</p></li>
<li><p><strong>regrid_tool</strong>: options include ‘esmf’ and ‘regrid2’</p></li>
<li><p><strong>metric_output_path</strong>: the full path to the metrics output in JSON files, e.g., ‘~/demo_data/PMP_metrics/’</p></li>
</ul>
<p>In addition to the above required input parameters, if the default cataolgue of observational climatologies is not being used its replacement needs to be specified, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">custom_observations</span> <span class="o">=</span> <span class="s1">&#39;./pcmdiobs2_clims_byVar_catalogue_v20200615.json&#39;</span>
</pre></div>
</div>
<p>The output of the mean climate summary statistics are saved in a JSON file.  <a class="reference external" href="https://github.com/PCMDI/pcmdi_metrics/blob/master/sample_setups/jsons/mean_climate/CMIP5/historical/v20190724/tas/ACCESS1-0.tas.CMIP5.historical.regrid2.2p5x2p5.v20190724.json">An example result</a> demonstrates that multiple statistics are computed for different conditions including regions and seasons. The resulting JSON files include the data, software and hardware information on how the summary statistics.</p>
<p>In addition to the minimum set of parameters noted above, the following <strong>additional options can be controlled</strong> for the mean climate:</p>
<ul class="simple">
<li><p><strong>cmec</strong> Flag to save summary statistics into a CMEC compliant JSON file or not.</p></li>
<li><p><strong>region_specs</strong> Define a different set of domains to compute the statistics (python dictionary).</p></li>
<li><p><strong>regions</strong> Specify which domains are applied to which variables (python dictionary).</p></li>
<li><p><strong>sftlf_filename_template</strong> Provided a land-sea mask to be used in defining regions.</p></li>
<li><p><strong>generate_sftlf</strong> Estimate a land-sea mask.</p></li>
<li><p><strong>save_test_clims</strong> Select to save (or not) interpolated climatologies including masking</p></li>
<li><p><strong>case_id</strong> Save JSON and netCDF files into a subdirectory so that results from multiple tests can be readily organized</p></li>
</ul>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="subdaily-precipitation.html" class="btn btn-neutral float-right" title="Sub-daily precipitation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="metrics-overview.html" class="btn btn-neutral float-left" title="Documentation and Demos" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020 PCMDI

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>